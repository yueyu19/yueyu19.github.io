---
title: 'Projection: Building blocks for constrained optimization methods'
date: 2021-10-03
permalink: /posts/2012/08/blog-post-2/
mathjax: true
tags:
  - mini-lecture notes
  - convex optimization
---

Constrained optimization is the minimization of a function subject to constraints. In this post, we will discuss a special class of constrained optimization, the projection onto structured convex sets. These projections can be computed using very simple formulas, and provide the bulding blocks for many popular constrained optimization methods.

# What is projection

Given a set $\mathbb{D}$ and a point $x$, a projection of $x$ onto set $\mathbb{D}$ is a point in set $\mathbb{D}$ that is closest to $x$ in terms of Euclidean distance. If set $\mathbb{D}$ is closed and convex, such projection is unique. We denote the projection of $x$ onto set $\mathbb{D}$ as $pi_{\mathbb{D}}[x]$, defined mathematically as follows:

$$\pi_{\mathbb{D}}[x]=\underset{y\in\mathbb{D}}{\mbox{argmin}}\,\, ||x-y||,$$

where
$$||\cdot||$$
denotes the $\ell_2$-norm.

# Why is projection useful

Projection is a building block for projected gradient method, and many other methods for constrained optimization, as we will show. 

Consider the minimization of a differentiable convex function $f:\mathbb{R}^n\to\mathbb{R}$ over a closed convex set $\mathbb{D}$. One of the most basic and powerful method for such minimization is the <em>projection gradient method</em>, which computes a sequence of estimate of the optimizer, $x^1, x^2, \ldots$, recursively as follows:
  
  $$x^{k+1}=\pi_{\mathbb{D}}[x^k-\alpha \nabla f(x^k)],$$
  
where $\alpha$ is a known positive scalar for step size.
  
The projection is also used in many advanced constrained optimization methods, including the [Douglas-Rachford splitting method](https://arxiv.org/pdf/1303.1090.pdf) and [Proportional-integral projected gradient method](https://arxiv.org/pdf/2108.10260.pdf).
 
# How to compute a projection
  
  In general, computing the projection onto set $\mathbb{D}$ can be non-trivial. For example, if $\mathbb{D}$ is a [convex polytope](https://en.wikipedia.org/wiki/Polytope), the computing the projection onto $\mathbb{D}$ is a [linear complementarity problem](https://en.wikipedia.org/wiki/Linear_complementarity_problem), which requires an iterative method itself.
  
## Examples of simple sets
  
  Fortunately, when set $\mathbb{D}$ has some particular structure, we can compute the projection onto $\mathbb{D}$ using very simple formulas, as we will show.
  
### Box
  
  Consider the following set $\mathbb{D}$
  
  $$ \mathbb{D}=\{y\in\mathbb{R}^n|l\leq y\leq u\},$$
  
  where $l, u\in\mathbb{R}^n$ are known lower and upper bounds.
  
  The projection of $x$ onto set $\mathbb{D}$ is given by
  
  $$\pi_{\mathbb{D}}[x]=\min\{\max\{x, l\}, u\}.$$
  
  An important special case of the box constraint set is the <em>nonnegative orthant<em>, where 
  
  $$\mathbb{D}=\{y\in\mathbb{R}^n| y\geq 0\}.$$
  
  In this case, the projection of $x$ onto set $\mathbb{D}$ becomes
  
  $$\pi_{\mathbb{D}}[x]=\max\{x, 0\}.$$
  
### Ball
  
  Consider the following set $\mathbb{D}$
  
  $$ \mathbb{D}=\{y\in\mathbb{R}^n| ||y||\leq \rho\},$$
  
  where $\rho\in\mathbb{R}$ is a known nonnegative radius.
  
  The projection of $x$ onto set $\mathbb{D}$ is given by
  
  $$\pi_{\mathbb{D}}[x]=\frac{\rho}{\max\{||x||, \rho\}}x.$$ 
  
### Cylinder
  
  Consider the following set $\mathbb{D}$
  
  $$ \mathbb{D}=\{y\in\mathbb{R}^n| -\eta\leq \langle e, y\rangle\leq \eta, ||y-\langle e, y\rangle e||\leq \rho\},$$

where $e\in\mathbb{R}^n$ with
$$||e||=1$$
, $\eta, \rho\in(0, \infty)$. Here vector $e$ determines the direction of the cylinder, $\eta$ and $\rho$ are the half-length and radius of the cylinder, respectively.
  
  The projection of $x$ onto set $\mathbb{D}$ can be computed in two steps. In the first step, we let
  
  $$ z=\begin{cases}
  x, & \text{if } -\eta\leq \langle e, x\rangle\leq \eta,\\
  x-(\langle e, x\rangle-\eta)e, & \text{if } \langle e, x\rangle>1,\\
  x-(\langle e, x\rangle+\eta)e, \text{if } \langle e, x\rangle<-1.
  \end{cases}$$
  
  In the second step, given vector $z$ computed in the first step, the projection of $x$ onto set $\mathbb{D}$ is given by
                                                                    
  $$\pi_{\mathbb{D}}[x]=\begin{cases}
  x, & \text{if } ||x-\langle e, x\rangle e||\leq \rho,\\
  \langle e, x\rangle e+\frac{\rho(x-\langle e, x\rangle e)}{||x-\langle e, x\rangle e||}, & \text{otherwise.}
  \end{cases} $$
                                                                      
### Icecream cone
   Consider the following set $\mathbb{D}$
  
  $$ \mathbb{D}=\{y\in\mathbb{R}^n| \gamma||x||\leq \langle x, e\rangle\},$$
                                                                  
where $e\in\mathbb{R}^n$ gives the direction of the cone and $\gamma\in[0, 1]$ is the cosine of the half-angle of the cone. 
                                                                    
The projection of $x$ onto set $\mathbb{D}$ is given by
                                    
$$\pi_{\mathbb{D}}[x]=\begin{cases}
  x, & \text{if } \gamma ||x||\leq \langle e, x\rangle,\\
  0, & \text{if } \sqrt{1-\gamma^2}||x||\leq -\langle e, x\rangle,\\
  \gamma e +\frac{\sqrt{1-\gamma^2}}{||x-\langle e, x\rangle e||}(x-\langle e, x\rangle e), & \text{otherwise.}
  \end{cases} $$
### Intersection of an icecream cone and a ball 
  Consider the following set $\mathbb{D}$
  
  $$ \mathbb{D}=\{y\in\mathbb{R}^n| \gamma||x||\leq \langle x, e\rangle, ||x||\leq \rho\},$$
                                                                  
where $e\in\mathbb{R}^n$ gives the direction of the cone and $\gamma\in[0, 1]$ is the cosine of the half-angle of the cone, $\rho\in(0, \infty)$ is the radius of the ball.
                                                                    
The projection of $x$ onto set $\mathbb{D}$ can be computed in two steps, In the first step, we let
                                    
$$z=\begin{cases}
  x, & \text{if } \gamma ||x||\leq \langle e, x\rangle,\\
  0, & \text{if } \sqrt{1-\gamma^2}||x||\leq -\langle e, x\rangle,\\
  \gamma e +\frac{\sqrt{1-\gamma^2}}{||x-\langle e, x\rangle e||}(x-\langle e, x\rangle e), & \text{otherwise.}
  \end{cases} $$
                                                                    
In the second step, given $z$ computed in the first step, the projection of $x$ onto set $\mathbb{D}$ is given by
                                                                    
$$\pi_{\mathbb{D}}[x]=\frac{\rho}{\max\{||z||, \rho\}}z.$$ 
                                                                    
## Projection onto the Cartesian product of sets
                                                                    
 One of the most useful property of projection is its decomposition over the Cartesian product of sets. In particular, let
                                                                    
 $$\mathbb{D}=\mathbb{D}_1\times \mathbb{D}_2, \,\, \mathbb{D}_1\subset\mathbb{R}^{n_1}, \,\, \mathbb{D}_2\subset\mathbb{R}^{n_2},$$
                                                                    
 where $\mathbb{D}_1\times \mathbb{D}_2$ denotes the [Cartesian product](https://en.wikipedia.org/wiki/Cartesian_product) of set $\mathbb{D}_1$ and $\mathbb{D}_2$. Furthermore, let
                                                                    
 $$x=\begin{bmatrix}x_1\\ x_2\end{bmatrix} x_1\in\mathbb{R}^{n_1}, \,\, x_2\in\mathbb{R}^{n_2}$$
                                                                    
 By using the definition of projection, one can verify the following
                                                                    
 $$\pi_{\mathbb{D}}[x]=\begin{bmatrix} \pi_{\mathbb{D}_1}[x_1]\\\pi_{\mathbb{D}_2}[x_2]\end{bmatrix}.$$
                                                                    
 In other words, if set $\mathbb{D}$ is defined by constraints that are separable across different segments of a vector, then computing the projection of vector $x$ onto set $\mathbb{D}$ reduces to the projections of each segment of vector $x$. This fact is particularly useful in the context of trajectory optimization in optimal control problems, see my recent work [here](https://arxiv.org/pdf/2108.10260.pdf) and [here](https://arxiv.org/pdf/2109.02756.pdf) for some examples. 
                                                                    
# Want some more examples
                                                                    
The examples of projection used in this post are mostly taken from the Chapter 29 in [Convex Analysis and Monotone Operator Theory by Bauschke and Combettes](https://www.springer.com/gp/book/9783319483108). For example, the projection onto an icecream cone is discussed in Exercise 29.12. The projection onto the intersection of a cone and a ball, however, is published more recnetly; see Theorem 7.1 [here](http://arxiv-export-lb.library.cornell.edu/pdf/1708.00585) for details. 
                                                                    
If you want to see some examples of how projection is used as a building block for optimization methods, please see my recent work on [Model predictive control](https://arxiv.org/pdf/2009.06980.pdf), [conic optimization](https://arxiv.org/pdf/2108.10260.pdf), [infeasibility detection in conic optimization](https://arxiv.org/pdf/2109.02756.pdf) for details. 

                                                                   
 

